# House Price Prediction - ML Project

Предсказание цен на недвижимость.


## Технологии

- **Python 3.8+**
- **pandas** - работа с данными
- **seaborn** - визуализация данных
- **scikit-learn** - машинное обучение
- **matplotlib** - построение графиков
- **numpy** - численные вычисления
- **xgboost** - градиентный бустинг

## Структура проекта

```
house-price-prediction/
│
├── src/                    # Исходный код проекта
│   ├── __init__.py
│   ├── data_loader.py     # Загрузка данных
│   ├── eda.py             # Исследовательский анализ данных
│   ├── model_training.py  # Обучение и оценка моделей
│   └── utils.py           # Вспомогательные функции
│
├── data/                   # Данные проекта
│   ├── raw/               # Исходные данные (можно добавить свои)
│   └── processed/         # Обработанные данные
│
├── models/                 # Сохраненные модели
│   └── best_model.pkl     # Лучшая обученная модель
│
├── results/                # Результаты анализа
│   ├── eda_visualizations.png
│   ├── correlation_matrix.png
│   ├── model_performance.png
│   ├── residuals_analysis.png
│   ├── feature_importance.png
│   └── conclusions.md      # Выводы анализа
│
├── main.py                 # Точка входа в проект
├── requirements.txt        # Зависимости проекта
└── README.md               # Документация
```

## Установка и запуск

1. Перейдите в директорию проекта:
```bash
cd house-price-prediction
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

**Примечание для macOS:** Если XGBoost не работает, установите OpenMP:
```bash
brew install libomp
```

3. Запустите проект:
```bash
python main.py
```

**Важно:** Проект работает и без XGBoost. Если библиотека недоступна, будут использованы только Linear Regression, Ridge и Random Forest.

## Результаты

После выполнения скрипта будут созданы следующие визуализации:

- `eda_visualizations.png` - исследовательский анализ данных (распределения, зависимости)
- `correlation_matrix.png` - корреляционная матрица признаков
- `model_performance.png` - сравнение предсказаний моделей с реальными значениями
- `residuals_analysis.png` - анализ остатков для проверки качества модели
- `feature_importance.png` - важность признаков для tree-based моделей
- `conclusions.md` - выводы анализа результатов

**Детальный анализ графиков и выводы см. в файле [results/conclusions.md](results/conclusions.md)**

## Модели

В проекте используются несколько регрессионных моделей:

1. **Linear Regression** - линейная регрессия (базовая модель)
2. **Ridge Regression** - регуляризованная линейная регрессия
3. **Random Forest** - случайный лес (ансамбль деревьев)
4. **XGBoost** - градиентный бустинг (опционально, требует OpenMP runtime)

Для лучшей модели выполняется **подбор гиперпараметров** с помощью GridSearchCV.

### Метрики оценки:
- **RMSE** (Root Mean Squared Error) - корень из среднеквадратичной ошибки
- **MAE** (Mean Absolute Error) - средняя абсолютная ошибка
- **R² Score** - коэффициент детерминации (насколько хорошо модель объясняет вариацию данных)
- **Cross-Validation R²** - оценка на кросс-валидации

## Особенности проекта

### Feature Engineering
- Площадь на спальню (показатель просторности)
- Общее количество комнат
- Площадь на этаж
- Комплексный признак комфорта (сумма удобств)
- Премиум дом (большая площадь + много удобств)
- Взаимодействия между признаками (площадь × комфорт, площадь × парковка)

### Обработка данных
- Автоматическая генерация синтетических данных (можно заменить на реальные)
- Кодирование категориальных переменных (Label Encoding)
- Масштабирование признаков (StandardScaler)
- Разделение на train/test (80/20)

### Моделирование
- Сравнение нескольких алгоритмов регрессии
- Кросс-валидация (5-fold) для оценки моделей
- Подбор гиперпараметров для лучшей модели
- Детальный анализ важности признаков
- Визуализация результатов (scatter plots, residual analysis)

## Использование своих данных

Чтобы использовать свои данные:

1. Поместите CSV файл в папку `data/raw/` с именем `housing_data.csv`
2. Убедитесь, что файл содержит колонку `price` (целевая переменная)
3. Запустите `python main.py`

Или укажите путь к файлу в коде:
```python
df = load_data(data_path='путь/к/вашему/файлу.csv')
```

## Автор

https://github.com/AliceKl0

